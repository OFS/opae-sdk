#!/usr/bin/env python
import unittest

# Refer to Andy's doc for these magic number:
# https://rd.altera.com/ice/product/Nadder/Documentation/FS/Nadder_Config_Data.docx
class MagicNumber(object):
    '''
    Keep all bitstream magic numbers in one place
    '''

    SECTION_DESCRIPTOR = 0x97566593
    CMF_DESCRIPTOR = 0x62294895
    CMF_DESCRIPTOR_CMF_DESCRIPTION = SECTION_DESCRIPTOR

    CMF_SECTION_DESCRIPTOR = 0x00464D43
    IO_SECTION_DESCRIPTOR = 0x00004f49
    CORE_SECTION_DESCRIPTOR = 0x45524f43
    HPS_SECTION_DESCRIPTOR = 0x00535048
    PR_SECTION_DESCRIPTOR = 0x00005250
    TEST_SECTION_DESCRIPTOR = 0x54534554
    CERT_SECTION_DESCRIPTOR = 0x54524543
    PUF_SECTION_DESCRIPTOR = 0x00465550
    HPIO_SECTION_DESCRIPTOR = 0x4f495048

    HASH_SHA_384 = 0x49303819
    HASH_SHA_512 = 0x64428810

    SSBL_HEADER = 0x31305341

    SIGNATURE_SINGLE_ROOT_ENTRY = 0x89259036
    SIGNATURE_MULTI_ROOT_ENTRY = 0x36733624
    SIGNATURE_PUBLIC_KEY_ENTRY = 0x92540917
    SIGNATURE_BLOCK0_ENTRY = 0x15364367
    SIGNATURE_CHAIN_ENTRY_MAGICS = [SIGNATURE_SINGLE_ROOT_ENTRY, SIGNATURE_MULTI_ROOT_ENTRY, SIGNATURE_PUBLIC_KEY_ENTRY, SIGNATURE_BLOCK0_ENTRY]

    SIGNATURE_HASH_SHA_256 = 0x00113305
    SIGNATURE_HASH_SHA_384 = 0x30548820

    SIGNATURE = 0x74881520

    # Public Key Magic for no enablement, which is used in Single Root formatted keychain
    PUBLIC_KEY_SINGLE_ROOT = 0x58700660
    # Public Key Magic for enablement valid, which is used in Multi Root formatted keychain
    PUBLIC_KEY_MULTI_ROOT = 0x40656643
    PUBLIC_KEY_MAGICS = [PUBLIC_KEY_SINGLE_ROOT, PUBLIC_KEY_MULTI_ROOT]

    ELLIPTIC_CURVE_SECP256R1 = 0x21339360
    ELLIPTIC_CURVE_SECP384R1 = 0x54326648

    ELLIPTIC_CURVE_BRAINPOOLP384R1 = 0x38183011
    ELLIPTIC_CURVE_SM2P256 = 0x94912983

    # same as CMF_DESCRIPTOR_CMF_DESCRIPTION?
    CERTIFICATE_ENGINEERING = 0x97566593
    UPGRADE_ACTION = 0x6DABF6E8

if __name__ == '__main__':
    unittest.main()
